package test1;

import java.io.File;
import java.io.IOException;
import java.util.HashMap;

public class Mainish {
        public static void main(String args[]) throws IOException{
               
               
                EmailSet hamTest = new EmailSet("/Users/otisskipper/Desktop/emails/hamtraining");
                EmailSet spamTest = new EmailSet("/Users/otisskipper/Desktop/emails/spamtraining");
       
                //System.out.println("Ham emails");
                //hamTest.displayInfo();
                //System.out.println("Spam emails");
                //spamTest.displayInfo();
               
                //System.out.println("hamMap:");
                //hamLex.printLexicon();
                //System.out.println();
                //System.out.println("spamMap:");
                //spamLex.printLexicon();
       
                int totalHam;
                int totalSpam;
                File spamFolder = new File("/Users/otisskipper/Desktop/emails/spamtesting");
                File[] listOfSpam = spamFolder.listFiles();
                File hamFolder = new File("/Users/otisskipper/Desktop/emails/hamtesting");
                File[] listOfHam = hamFolder.listFiles();
                for(int m = 0; m < 4; m++){
                        for(int k = 0; k<4; k++){
                                System.out.println();
                                System.out.println("m: " + m + " -- k: " + k);

                                HashMap<String, Integer> hamHash = hamTest.wordFrequency();
                                HashMap<String, Integer> spamHash = spamTest.wordFrequency();
                               
                                Lexicon hamLex = new Lexicon(hamHash,k,m);
                                Lexicon spamLex = new Lexicon(spamHash,k,m);
                               
                                //System.out.println("testing on spam");
                                totalSpam = 0;
                                totalHam = 0;
                                for (File file : listOfSpam) {
                                    if (file.isFile()&&file.getName().endsWith(".txt")) {
                                          Email email = new Email(file.getPath());
                                          EmailTester Etester = new EmailTester(hamLex, spamLex, email,hamTest.totalEmails(),spamTest.totalEmails());
                                                if(Etester.isHam()){
                                                        //System.out.println("Email was ham");
                                                        totalHam++;
                                                }
                                                else{
                                                        totalSpam++;
                                                        //System.out.println("Email was spam");
                                                }
                                    }
                                }
                                System.out.println("Spam Accuracy: " + (double)totalSpam/(totalHam + totalSpam) + "%");
                               
                                //System.out.println("testing on ham");
                                totalSpam = 0;
                                totalHam = 0;
                                for (File file : listOfHam) {
                                    if (file.isFile()&&file.getName().endsWith(".txt")) {
                                          Email email = new Email(file.getPath());
                                          EmailTester Etester = new EmailTester(hamLex, spamLex, email,hamTest.totalEmails(),spamTest.totalEmails());
                                                if(Etester.isHam()){
                                                        //System.out.println("Email was ham");
                                                        totalHam++;
                                                }
                                                else{
                                                        totalSpam++;
                                                        //System.out.println("Email was spam");
                                                }
                                    }
                                }
                                System.out.println("Ham Accuracy: " + (double) totalHam/(totalHam + totalSpam) + "%");
                        }
                }
        }
}
